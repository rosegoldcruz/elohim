"use strict";(()=>{var e={};e.id=3527,e.ids=[3527],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{e.exports=require("querystring")},11997:e=>{e.exports=require("punycode")},12412:e=>{e.exports=require("assert")},13440:e=>{e.exports=require("util/types")},23405:e=>{e.exports=require("@supabase/ssr")},27910:e=>{e.exports=require("stream")},28086:(e,r,t)=>{t.d(r,{U:()=>i});var o=t(23405),s=t(44999);let i=()=>{let e=(0,s.UL)();return(0,o.createServerClient)("https://iqcwwufogdoaiuzyqney.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlxY3d3dWZvZ2RvYWl1enlxbmV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzNjUwNTIsImV4cCI6MjA2Nzk0MTA1Mn0.3ltBkJWpgrzwu0Rlrdj9LmoNbnk7cki_2B9y1x6HlWs",{cookies:{get:r=>e.get(r)?.value,set(r,t,o){e.set({name:r,value:t,...o})},remove(r,t){e.set({name:r,value:"",...t})}}})}},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},36686:e=>{e.exports=require("diagnostics_channel")},37830:e=>{e.exports=require("node:stream/web")},38971:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>x,routeModule:()=>g,serverHooks:()=>m,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>_});var o={};t.r(o),t.d(o,{GET:()=>l,POST:()=>d});var s=t(96559),i=t(48088),n=t(37719),a=t(32190),u=t(54316),p=t(28086),c=t(71736);async function d(e){try{let r;console.log("\uD83C\uDFAC Video Generation API: Starting request...");let{topic:t,style:o="TikTok/Documentary",duration:s=60,user_id:i,project_name:n,custom_script:d}=await e.json();if(!t&&!d)return a.NextResponse.json({error:"Topic or custom script is required"},{status:400});if(!i)return a.NextResponse.json({error:"User ID is required"},{status:400});if(!c._.OPENAI_API_KEY)return a.NextResponse.json({error:"OpenAI API key not configured"},{status:500});if(!c._.REPLICATE_API_TOKEN)return a.NextResponse.json({error:"Replicate API key not configured"},{status:500});console.log(`🎯 Generating video for user ${i}: "${t||"Custom Script"}"`),console.log(`📊 Parameters: ${s}s, ${o} style`);let l=(0,p.U)(),{data:g,error:f}=await l.from("projects").insert({user_id:i,title:n||t||"Custom Video",description:`AI-generated video: ${t||"Custom script"}`,style:o,duration:s,status:"processing",created_at:new Date().toISOString()}).select().single();if(f)return console.error("❌ Failed to create project:",f),a.NextResponse.json({error:"Failed to create project record"},{status:500});console.log(`✅ Created project: ${g.id}`);let _=new u.e6,m=async(e,r,t,o)=>{console.log(`📊 Progress: ${e} - ${r}% - ${t} (${o})`),await l.from("projects").update({progress:r,current_stage:e,status_message:t,current_agent:o,updated_at:new Date().toISOString()}).eq("id",g.id)};if(r=d?await _.executeCustomScript({user_id:i,project_id:g.id,script:d,style:o,duration:s},m):await _.execute({user_id:i,project_id:g.id,topic:t,style:o,duration:s,platform:"tiktok"},m),await l.from("projects").update({status:r.success?"completed":"failed",progress:100,video_url:r.video_url,file_size:r.file_size,processing_time:r.processing_time,agents_used:r.agents_used,error_message:r.error,completed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",g.id),r.success)return console.log(`✅ Video generation completed successfully!`),console.log(`📹 Video URL: ${r.video_url}`),console.log(`⏱️ Processing time: ${r.processing_time}ms`),console.log(`🤖 Agents used: ${r.agents_used.join(", ")}`),a.NextResponse.json({success:!0,project_id:g.id,video_url:r.video_url,file_size:r.file_size,processing_time:r.processing_time,agents_used:r.agents_used,metadata:{topic:t||"Custom Script",style:o,duration:s,scenes_generated:r.scenes_generated||0,total_duration:r.total_duration||s}});return console.error(`❌ Video generation failed: ${r.error}`),a.NextResponse.json({success:!1,project_id:g.id,error:r.error,processing_time:r.processing_time,agents_used:r.agents_used},{status:500})}catch(e){return console.error("❌ Video Generation API error:",e),a.NextResponse.json({success:!1,error:"Video generation failed",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(){return a.NextResponse.json({message:"AEON Video Generation API",description:"Generate complete AI videos using the full agent pipeline",usage:{method:"POST",endpoint:"/api/video/generate",body:{topic:"string (required if no custom_script) - The video topic",custom_script:"string (required if no topic) - Custom script content",style:"string (optional) - Video style, default: 'TikTok/Documentary'",duration:"number (optional) - Video duration in seconds, default: 60",user_id:"string (required) - User identifier",project_name:"string (optional) - Custom project name"}},pipeline:["TrendsAgent - Analyze trending topics","ScriptWriterAgent - Generate viral script","ScenePlannerAgent - Plan scene timing","VisualGeneratorAgent - Generate video scenes","StitcherAgent - Combine scenes with FFmpeg","EditorAgent - Final post-processing"],requirements:{api_keys:["OPENAI_API_KEY","REPLICATE_API_TOKEN"],database:"Supabase for project tracking",storage:"Vercel Blob for video files"}})}let g=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/video/generate/route",pathname:"/api/video/generate",filename:"route",bundlePath:"app/api/video/generate/route"},resolvedPagePath:"C:\\Users\\Administrator\\Elohim\\frontend\\app\\api\\video\\generate\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:f,workUnitAsyncStorage:_,serverHooks:m}=g;function x(){return(0,n.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:_})}},41204:e=>{e.exports=require("string_decoder")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},54287:e=>{e.exports=require("console")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},57075:e=>{e.exports=require("node:stream")},57975:e=>{e.exports=require("node:util")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{e.exports=require("node:fs")},73496:e=>{e.exports=require("http2")},73566:e=>{e.exports=require("worker_threads")},74075:e=>{e.exports=require("zlib")},74998:e=>{e.exports=require("perf_hooks")},76926:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return u}});let o=function(e,r){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s(r);if(t&&t.has(e))return t.get(e);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var a=i?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}(t(61120));function s(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(s=function(e){return e?t:r})(e)}let i={current:null},n="function"==typeof o.cache?o.cache:e=>e,a=console.warn;function u(e){return function(...r){a(e(...r))}}n(e=>{try{a(i.current)}finally{i.current=null}})},78474:e=>{e.exports=require("node:events")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},79646:e=>{e.exports=require("child_process")},79748:e=>{e.exports=require("fs/promises")},81630:e=>{e.exports=require("http")},84297:e=>{e.exports=require("async_hooks")},91645:e=>{e.exports=require("net")},94175:e=>{e.exports=require("stream/web")},94735:e=>{e.exports=require("events")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[4447,580,2289,4999,7478,1746,2419,4448,3010,596,4316],()=>t(38971));module.exports=o})();