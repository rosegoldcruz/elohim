(()=>{var e={};e.id=7831,e.ids=[7831],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},24392:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>l,serverHooks:()=>x,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{DELETE:()=>c,GET:()=>u,POST:()=>d});var a=t(96559),n=t(48088),o=t(37719),i=t(32190);async function u(e){try{let{searchParams:r}=new URL(e.url),t=r.get("projectId");if(!t)return i.NextResponse.json({error:"Project ID is required"},{status:400});let s=createClient(),{data:{user:a},error:n}=await s.auth.getUser();if(n||!a)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:o,error:u}=await s.from("scenes").select(`
        id,
        name,
        duration,
        thumbnail_url,
        video_url,
        beat_markers,
        metadata,
        created_at
      `).eq("project_id",t).eq("user_id",a.id).order("created_at",{ascending:!0});if(u)return console.error("Error fetching scenes:",u),i.NextResponse.json({error:"Failed to fetch scenes"},{status:500});let d=o?.map(e=>({id:e.id,name:e.name,duration:e.duration,thumbnail:e.thumbnail_url,videoUrl:e.video_url,beatMarkers:e.beat_markers||[],metadata:{resolution:e.metadata?.resolution||"1080x1920",fps:e.metadata?.fps||30,fileSize:e.metadata?.file_size||0,createdAt:e.created_at}}))||[];return i.NextResponse.json({success:!0,scenes:d,count:d.length})}catch(e){return console.error("Error in GET /api/editor/scenes:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let{action:r,projectId:t,sceneData:s,sceneOrder:a}=await e.json(),n=createClient(),{data:{user:o},error:u}=await n.auth.getUser();if(u||!o)return i.NextResponse.json({error:"Unauthorized"},{status:401});if("reorder"===r){if(!a||!Array.isArray(a))return i.NextResponse.json({error:"Scene order array is required"},{status:400});let e=a.map((e,r)=>n.from("scenes").update({order_index:r}).eq("id",e).eq("user_id",o.id));return await Promise.all(e),i.NextResponse.json({success:!0,message:"Scene order updated successfully"})}if("create"===r){if(!s||!t)return i.NextResponse.json({error:"Scene data and project ID are required"},{status:400});let{data:e,error:r}=await n.from("scenes").insert({project_id:t,user_id:o.id,name:s.name,duration:s.duration,thumbnail_url:s.thumbnail,video_url:s.videoUrl,beat_markers:s.beatMarkers||[],metadata:s.metadata}).select().single();if(r)return console.error("Error creating scene:",r),i.NextResponse.json({error:"Failed to create scene"},{status:500});return i.NextResponse.json({success:!0,scene:{id:e.id,name:e.name,duration:e.duration,thumbnail:e.thumbnail_url,videoUrl:e.video_url,beatMarkers:e.beat_markers||[],metadata:e.metadata}})}return i.NextResponse.json({error:"Invalid action"},{status:400})}catch(e){return console.error("Error in POST /api/editor/scenes:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function c(e){try{let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return i.NextResponse.json({error:"Scene ID is required"},{status:400});let s=createClient(),{data:{user:a},error:n}=await s.auth.getUser();if(n||!a)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{error:o}=await s.from("scenes").delete().eq("id",t).eq("user_id",a.id);if(o)return console.error("Error deleting scene:",o),i.NextResponse.json({error:"Failed to delete scene"},{status:500});return i.NextResponse.json({success:!0,message:"Scene deleted successfully"})}catch(e){return console.error("Error in DELETE /api/editor/scenes:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/editor/scenes/route",pathname:"/api/editor/scenes",filename:"route",bundlePath:"app/api/editor/scenes/route"},resolvedPagePath:"C:\\Users\\Administrator\\Elohim\\frontend\\app\\api\\editor\\scenes\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:m,serverHooks:x}=l;function f(){return(0,o.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:m})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580],()=>t(24392));module.exports=s})();